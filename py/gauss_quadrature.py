'''
Created on Sep 12, 2015

@author: MBB
'''
import numpy as np
from numpy import float64
from numpy.polynomial.legendre import leggauss

class GaussQuadrature(object):
    '''
    '''

    def __init__(self,numGaussPoints=10, numLogarithmicGaussPoints=10 ):
        '''
        This will initiate, what degree of gauss quadrature to be used and returns logarithmic and normal gauss quadratures
        '''
        [gaussPoint,gaussWeight] = leggauss(numGaussPoints)
        # Logarithmic gauss quadrature      
        [gaussPoint_sp,gaussWeight_sp] = self.logarithmicQuadrature(numLogarithmicGaussPoints)
        
        self.Point= gaussPoint
        self.Weight = gaussWeight
        self.Point_sp = gaussPoint_sp
        self.Weight_sp = gaussWeight_sp
    
    def logarithmicQuadrature(self,deg):
        '''
        '''
        
        if deg == 2:
            logGaussPoint = np.array([0.112008806166976, 0.602276908118738], dtype = float64)
            logGaussWeight = np.array([0.718539319030385,0.281460680969616], dtype = float64)
            
        elif deg == 3:
            logGaussPoint = np.array([0.638907930873254e-1, 0.368997063715619, \
                                      0.766880303938942], dtype = float64)
            logGaussWeight = np.array([0.513404552232363, 0.391980041201488, \
                                       0.946154065661491e-1], dtype = float64)
            
        elif deg == 4:
            logGaussPoint = np.array([0.414484801993832,0.245274914320602,0.556165453560276,\
                                      0.848982394532985], dtype = float64)
            logGaussWeight = np.array([0.383464068145135,0.386875317774763,0.190435126950142,\
                                       0.392254871299598e-1], dtype = float64)
            
        elif deg == 5:
            logGaussPoint = np.array([0.291344721519721e-1,0.173977213320898,0.411702520284902,\
                                      0.677314174582820,0.894771361031008], dtype = float64)
            logGaussWeight = np.array([0.297893471782894,0.349776226513224,0.234488290044052,\
                                       0.989304595166331e-1,0.189115521431958e-1], dtype = float64)
            
        elif deg == 6:
            logGaussPoint = np.array([0.216340058441169e-1,0.129583391154951,0.314020449914766\
                                      ,0.538657217351802,0.756915337377403,0.922668851372120], dtype = float64)
            logGaussWeight = np.array([0.238763662578548,0.308286573273947,0.245317426563210,\
                                       0.142008756566477,0.554546223248863e-1,0.101689586929323e-1], dtype = float64)
            
        elif deg == 7:
            logGaussPoint = np.array([0.167193554082585e-1,0.100185677915675,0.246294246207931,0.433463493257033,\
                                      0.632350988047766,0.811118626740106,0.940848166743348], dtype = float64)
            logGaussWeight = np.array([0.196169389425248,0.270302644247273,0.239681873007691,0.165775774810433,\
                                       0.889432271376580e-1,0.331943043565711e-1,0.593278701512593e-2], dtype = float64)
            
        elif deg == 8:
            logGaussPoint = np.array([0.133202441608925e-1,0.797504290138949e-1,0.197871029326188,0.354153994351909,\
                                      0.529458575234917,0.701814529939100,0.849379320441107,0.953326450056360], dtype = float64)
            logGaussWeight = np.array([0.164416604728003,0.237525610023306,0.226841984431919,0.175754079006070,\
                                       0.112924030246759,0.578722107177821e-1,0.209790737421330e-1,0.368640710402762e-2], dtype = float64)
            
        elif deg == 9:
            logGaussPoint = np.array([0.108693360841755e-1,0.649836663380079e-1,0.162229398023883,0.293749903971675,0.446631881905468,\
                                      0.605481662776129,0.754110137157164,0.877265828835838,0.962250559410282], dtype = float64)
            logGaussWeight = np.array([0.140068438748135,0.209772205201030,0.211427149896603,0.177156233938080,0.127799228033206,\
                                       0.784789026115622e-1,0.390225049853991e-1,0.138672955495930e-1,0.240804103639231e-2], dtype = float64)
            
        elif deg == 10:
            logGaussPoint = np.array([0.904263096219965e-2,0.539712662225006e-1,0.135311824639251,0.247052416287160,\
                                      0.380212539609332,0.523792317971843,0.665775205516425,0.794190416011966,0.898161091219004,\
                                      0.968847988718634], dtype = float64)
            '''
            logGaussWeight = np.array([0.120955131954571,0.186363542564072,0.195660873277760,0.173577142182907,0.135695672995484,\
                                       0.936467585381105e-1,0.557877273514159e-1,0.271598108992333e-1,0.951518260284852e-2,\
                                       0.163815763359826e-2], dtype = float64)
            '''
            logGaussWeight = np.array([0.1209551319,0.1863635425,0.1956608732,0.1735771421,0.1356956729,0.0936467585,\
                                       0.0557877273,0.0271598109,0.0095151826,0.0016381576], dtype = float64)
            
        elif deg == 12:
            logGaussPoint = np.array([0.654872227908006e-2,0.389468095604500e-1,0.981502631060066e-1,0.181138581590632,\
                                      0.283220067667373,0.398434435163437,0.519952626792353,0.640510916716107,\
                                      0.752865012051831,0.850240024162302,0.926749683223914,0.977756129689998], dtype = float64)
            logGaussWeight = np.array([0.931926914439313e-1,0.149751827576322,0.166557454364593,0.159633559436988,\
                                       0.138424831864836,0.110016570635721,0.799618217708290e-1,0.524069548246418e-1,\
                                       0.300710888737612e-1,0.142492455879983e-1,0.489992458232176e-2,0.834029038056903e-3], dtype = float64)
            
        elif deg == 14:
            logGaussPoint = np.array([0.496600357386854e-2,0.294325401188852e-1,0.743762922245358e-1,0.138138491989186,0.218055648498959,\
                                      0.310662083918102,0.411872475177750,0.517179307398654,0.621864859728511,0.721220745208109,\
                                      0.810765988071590,0.886454038034435,0.944859139461819,0.983331026485678], dtype = float64)
            logGaussWeight = np.array([0.742912250675104e-1,0.122988772469323,0.142199306562523,0.143229297641264,0.132345083772085,\
                                       0.114135875736676,0.922830380790736e-1,0.697536732939376e-1,0.488303236005136e-1,0.311017960644161e-1,\
                                       0.174628119501961e-1,0.814242342987594e-2,0.276843641856394e-2,0.467935914040560e-3], dtype = float64)
            
        elif deg == 16:
            logGaussPoint = np.array([0.389783448711592e-2,0.230289456168732e-1,0.582803983062404e-1,0.108678365091054,\
                                      0.172609454909844,0.247937054470578,0.332094549129917,0.422183910581949,\
                                      0.515082473381463,0.607556120447729,0.696375653228214,0.778432565873265,\
                                      0.850850269715391,0.911086857222272,0.957025571703542,0.987047800247984], dtype = float64)
            logGaussWeight = np.array([0.607917100435912e-1,0.102915677517582,0.122355662046009,0.127569246937016,\
                                       0.123013574600071,0.111847244855486,0.965963851521243e-1,0.793566643514731e-1,\
                                       0.618504945819652e-1,0.454352465077267e-1,0.310989747515818e-1,0.194597659273608e-1,\
                                       0.107762549632055e-1,0.497254289008764e-2,0.167820111005119e-2,0.282353764668436e-3], dtype = float64)
            
        return [logGaussPoint,logGaussWeight]
    
    


